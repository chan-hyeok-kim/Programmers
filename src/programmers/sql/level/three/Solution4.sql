SELECT A.ANIMAL_ID,A.NAME
  FROM 
(SELECT AO.ANIMAL_ID,AO.NAME,DENSE_RANK() OVER(ORDER BY AO.DATETIME-AI.DATETIME DESC) AS RANK
  FROM ANIMAL_INS AI INNER JOIN ANIMAL_OUTS AO
    ON AI.ANIMAL_ID=AO.ANIMAL_ID
) A
 WHERE RANK<=2
 ORDER BY RANK;
	 -- 오랜 기간 보호한 동물(2)